import{r as u,E as i,P as c,L as n,K as a,G as s,T as v,H as ne,Q as m,O as d,R as I,au as ue,M as A,av as re,q as ie,D as L,F as x,U as de}from"./index.f77abd2b.js";import{l as P,m as Q}from"./QDialog.eb5986ff.js";import{Q as ce,a as B,b as me}from"./QTable.8e0fe829.js";import{Q as F,a as M}from"./QTd.ec8175d6.js";import{Q as G,C as pe}from"./ClosePopup.f9838403.js";import{c as q,b as ve,Q as Z}from"./QCard.cba0760b.js";import{Q as fe,a as p}from"./QForm.f6f09dea.js";import{Q as j}from"./QCardActions.ab5a597e.js";import{d as z}from"./docente.1b21368a.js";const be={class:"q-pa-md"},ge={class:"row justify-between"},_e=n("div",{class:"col-9"},[n("div",{class:"col q-table__title",inline:""},[n("b",null,"Administrar Docentes")])],-1),we={class:"col-3",align:"right"},ye=n("div",{class:"col q-table__title"},[n("b",null,"Lista de Docentes")],-1),he={key:0,style:{display:"inline"}},Ce={style:{display:"inline"}},Ve=n("div",{class:"q-pa-md"},null,-1),Ne={class:"text-h6"},Oe={class:"row"},Ae={class:"row"},Qe={class:"row"},ke={class:"col-6"},De={class:"col-6"},Ee={class:"row"},xe={class:"col-2"},Ke={class:"col-10 q-pt-xs"},Be={__name:"MainPage",setup(Ue){const R=ve(),k=u(null),f=u(null),b=u(null),g=u(null),_=u(null),w=u(null),y=u(null),H=u(null),h=u(null);u([]);const D=u(null),J=["DOCENTE","DIRECTOR"],E=u(!1),K=u(null),U=u(null),W=[{name:"nombre",align:"center",label:"Nombre",field:"nombre",style:"max-width: 200px; white-space: break-spaces;"},{name:"cedula",align:"center",label:"C\xE9dula",field:"cedula"},{name:"correo",align:"center",label:"Email",field:"correo"},{name:"dedicacion",align:"center",label:"Dedicaci\xF3n",field:"dedicacion",style:"max-width: 200px; white-space: break-spaces;"},{name:"rol",align:"center",label:"Rol",field:"rol"},{name:"estado",align:"center",label:"Estado Cuenta",field:"estado"}],S=u([]),C=u(!1),V=ne(),N=async()=>{await z.obtenerDocentes(o=>{if(o.status==401)return r("NO OK",o.message),V.push({path:"/"});if(o.status!=200)return r("NO OK",o.message);let l=[];U.value=o.data;for(let e=0;e<U.value.length;e++){const t=U.value[e],O=`${t.primerNombre} ${t.segundoNombre} ${t.primerApellido} ${t.segundoApellido}`;l.push({id:t._id,nombre:O,primerNombre:t.primerNombre,segundoNombre:t.segundoNombre,primerApellido:t.primerApellido,segundoApellido:t.segundoApellido,estado:t.usuario.estado,isActual:!!t.isActual,rol:t.usuario.rol.nombre.toUpperCase(),cedula:t.cedula,correo:t.correo,dedicacion:t.dedicacion})}S.value=l})},X=async o=>{await z.crearDocente(o,l=>{if(l.status==401)return r("NO OK",l.message),V.push({path:"/"});if(l.status!=200)return r("NO OK",l.message);r("OK",l.data.message),T(),N()})},Y=async(o,l)=>{await z.editarDocente(o,l,e=>{if(e.status==401)return r("NO OK",e.message),V.push({path:"/"});if(e.status!=200)return r("NO OK",e.message);r("OK",e.data.message),T(),N()})},ee=async()=>{await $(),k.value="Crear Nuevo Docente",C.value=!0},le=async o=>{await $(),D.value=o.id,k.value="Editar Informaci\xF3n del Docente",f.value=o.primerNombre,b.value=o.segundoNombre,g.value=o.primerApellido,_.value=o.segundoApellido,w.value=o.correo.split("@")[0],y.value=o.cedula,h.value=o.dedicacion,C.value=!0},T=()=>{C.value=!1,$()},ae=async o=>{E.value=!0,K.value=o},oe=async()=>{await L.cambiarEstado(K.value.cedula,o=>{if(o.status==401)return r("NO OK",o.message),V.push({path:"/"});if(o.status!=200)return r("NO OK",o.message);r("OK","El estado de la cuenta del docente ha sido cambiado"),E.value=!1,N()})},te=async()=>{const o={primerNombre:f.value,segundoNombre:b.value,primerApellido:g.value,segundoApellido:_.value,cedula:y.value,correo:w.value+"@unl.edu.ec",dedicacion:h.value};return D.value==null?X(o):Y(D.value,o)},$=()=>{k.value=null,f.value=null,b.value=null,g.value=null,_.value=null,w.value=null,y.value=null,H.value=null,h.value=null,D.value=null},se=async o=>{await L.cambiarRol(o.id,o.rol.toLowerCase(),l=>{if(l.status==401)return r("NO OK",l.message),V.push({path:"/"});if(l.status!=200)return r("NO OK",l.message);r("OK","El rol del docente ha sido cambiado"),N()})},r=(o,l)=>{o=="OK"?R.notify({color:"green-5",textColor:"white",icon:"mdi-check-bold",message:l}):R.notify({color:"red-5",textColor:"white",icon:"warning",message:l})};return N(),(o,l)=>(i(),c(v,null,[n("div",be,[a(q,{class:"my-card"},{default:s(()=>[a(Q,{class:"card-title-gestionar"},{default:s(()=>[n("div",ge,[_e,n("div",we,[a(m,{onClick:l[0]||(l[0]=e=>ee()),size:"sm",class:"col-1 bton-lista-docente",color:"secondary",style:{color:"white"}},{default:s(()=>[d("NUEVO DOCENTE")]),_:1})])])]),_:1}),a(Q,null,{default:s(()=>[a(ce,{title:"Lista de Docentes",rows:S.value,columns:W,"row-key":"name","rows-per-page-options":[5,10,0]},{top:s(()=>[ye]),header:s(e=>[a(F,{props:e},{default:s(()=>[(i(!0),c(v,null,I(e.cols,t=>(i(),x(B,{key:t.name,props:e},{default:s(()=>[d(A(t.label),1)]),_:2},1032,["props"]))),128)),a(B,{"auto-width":""},{default:s(()=>[d("Opciones")]),_:1})]),_:2},1032,["props"])]),body:s(e=>[a(F,{props:e,class:ue(e.row.estado?e.row.isActual?"bg-indigo-1":"":"bg-red-1 ")},{default:s(()=>[(i(!0),c(v,null,I(e.cols,t=>(i(),x(M,{key:t.name,props:e},{default:s(()=>[t.name=="estado"?(i(),c("div",he,[a(m,{size:"sm",color:t.value?"positive":"negative",dense:"",label:t.value?"ACTIVO":"INACTIVO",onClick:O=>e.row.isActual?"":ae(e.row)},null,8,["color","label","onClick"]),e.row.isActual?de("",!0):(i(),x(G,{key:0,offset:[10,10],class:"bg-indigo"},{default:s(()=>[d(" Cambiar estado cuenta ")]),_:1}))])):t.name=="rol"?(i(),c(v,{key:1},[e.row.isActual?(i(),c(v,{key:1},[d(A(t.value),1)],64)):(i(),x(me,{key:0,modelValue:e.row.rol,"onUpdate:modelValue":[O=>e.row.rol=O,O=>se(e.row)],dense:"",options:J},null,8,["modelValue","onUpdate:modelValue"]))],64)):(i(),c(v,{key:2},[d(A(t.value),1)],64))]),_:2},1032,["props"]))),128)),a(M,{align:"center","auto-width":""},{default:s(()=>[n("div",Ce,[a(m,{size:"sm",color:"warning",round:"",dense:"",onClick:t=>le(e.row),icon:"mdi-account-edit"},null,8,["onClick"]),a(G,{offset:[10,10],class:"bg-indigo"},{default:s(()=>[d(" Editar docente ")]),_:1})])]),_:2},1024)]),_:2},1032,["props","class"])]),_:1},8,["rows"])]),_:1})]),_:1})]),Ve,a(P,{modelValue:C.value,"onUpdate:modelValue":l[8]||(l[8]=e=>C.value=e)},{default:s(()=>[a(q,null,{default:s(()=>[a(Q,{class:"header-crear-docente card-title-gestionar"},{default:s(()=>[n("div",Ne,A(k.value),1)]),_:1}),a(Z,{class:"q-separator-crear-docente"}),a(Q,{style:{"max-height":"70vh"},class:"scroll body-crear-docente"},{default:s(()=>[a(fe,{onSubmit:te,onReset:T,class:"q-gutter-x-md"},{default:s(()=>[n("div",Oe,[a(p,{class:"col label-mid",filled:"",modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=e=>f.value=e),label:"Primer nombre","lazy-rules":"",rules:[e=>e&&e.length>0||"Completa este campo"]},null,8,["modelValue","rules"]),a(p,{class:"col label-mid",filled:"",modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=e=>b.value=e),label:"Segundo nombre"},null,8,["modelValue"])]),n("div",Ae,[a(p,{class:"col label-mid",filled:"",modelValue:g.value,"onUpdate:modelValue":l[3]||(l[3]=e=>g.value=e),label:"Primer apellido","lazy-rules":"",rules:[e=>e&&e.length>0||"Completa este campo"]},null,8,["modelValue","rules"]),a(p,{class:"col label-mid",filled:"",modelValue:_.value,"onUpdate:modelValue":l[4]||(l[4]=e=>_.value=e),label:"Segundo apellido","lazy-rules":"",rules:[e=>e&&e.length>0||"Completa este campo"]},null,8,["modelValue","rules"])]),a(p,{filled:"",modelValue:w.value,"onUpdate:modelValue":l[5]||(l[5]=e=>w.value=e),class:"col label-mid",suffix:"@unl.edu.ec",label:"Correo institucional","lazy-rules":"",rules:[e=>e&&e.length>0||"Completa este campo",e=>/^[-\w.%+]{1,64}@(?:[A-Z0-9-]{1,63}\.){1,125}[A-Z]{2,63}$/i.test(e+"@unl.edu.ec")||"Formato de email no v\xE1lido"]},null,8,["modelValue","rules"]),n("div",Qe,[n("div",ke,[a(p,{class:"col label-mid",filled:"",modelValue:y.value,"onUpdate:modelValue":l[6]||(l[6]=e=>y.value=e),label:"Numero de C\xE9dula","lazy-rules":"",rules:[e=>e&&e.length>0||"Completa este campo",e=>e.length==10&&!isNaN(e)||"C\xE9dula no correcta"]},null,8,["modelValue","rules"])]),n("div",De,[a(p,{class:"col label-mid",filled:"",modelValue:h.value,"onUpdate:modelValue":l[7]||(l[7]=e=>h.value=e),label:"Dedicaci\xF3n","lazy-rules":"",rules:[e=>e&&e.length>0||"Completa este campo"]},null,8,["modelValue","rules"])])]),a(Z,{class:"q-separator-crear-docente"}),a(j,{align:"right",class:"header-crear-docente"},{default:s(()=>[a(m,{type:"reset",class:"btn-cancelar-docente",flat:"",label:"Cancelar",color:"white"}),a(m,{type:"submit",class:"btn-crear-docente",flat:"",label:"Guardar",color:"white"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(P,{modelValue:E.value,"onUpdate:modelValue":l[10]||(l[10]=e=>E.value=e),persistent:""},{default:s(()=>[a(q,{style:{"max-width":"400px"}},{default:s(()=>[a(Q,{class:"row items-center"},{default:s(()=>[n("div",Ee,[n("div",xe,[a(re,{icon:"warning",color:"warning","text-color":"white"})]),n("div",Ke,[n("span",null,[d("Est\xE1 a p\xFAnto de cambiar el estado de cuenta del docente: "),n("b",null,A(K.value.nombre),1)])])])]),_:1}),a(j,{align:"right"},{default:s(()=>[ie(a(m,{flat:"",label:"Cancel",color:"negative"},null,512),[[pe]]),a(m,{flat:"",label:"Aceptar",color:"primary",onClick:l[9]||(l[9]=e=>oe())})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{Be as default};
